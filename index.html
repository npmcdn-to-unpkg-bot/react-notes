<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>React Notes</title>

    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.4.0/css/font-awesome.min.css">
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.2/html5shiv.js"></script>
      <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->
  </head>
  <body>
    <div class="container">
      <div class="col-md-6">
        <h1>Notes</h1>
        <hr>
        <div class="react-endpoint" id="example">
        </div>
      </div>

      <div class="col-md-6">
        <h1>React-Notes-App-Breakdown</h1>
      <hr>
        <h3>The goal of this exercise is to use react correctly in order to create an app that saves notes in a JSON file.</h3>
        <hr>
        <ol>
          <li><i class="fa fa-check" aria-hidden="true"></i> Get Libs Loaded Successfully.</li>
          <li><i class="fa fa-check" aria-hidden="true"></i> Get Hello Loaded via Component.</li>
          <li><i class="fa fa-check" aria-hidden="true"></i> Get Input Field On Page.</li>
          <li><i class="fa fa-check" aria-hidden="true"></i> Add a Submit Button</li>
          <li><i class="fa fa-check" aria-hidden="true"></i> Start A Server via Hapi</li>
          <li><i class="fa fa-check" aria-hidden="true"></i> Create A Route To Your <code>index.html</code> In Your Server</li>
          <li><i class="fa fa-check" aria-hidden="true"></i> Create a JSON file with mock note data</li>
          <li><i class="fa fa-check" aria-hidden="true"></i> Create A Route For Getting JSON and Make CURL To Test</li>
          <li><i class="fa fa-check" aria-hidden="true"></i> Create a Previous Notes Component</li>
          <li><i class="fa fa-check" aria-hidden="true"></i> Figure out how make a AJAX request using jQuery</li>
          <li><i class="fa fa-check" aria-hidden="true"></i> Get Static Data Loaded on The Page</li>
          <li><i class="fa fa-check" aria-hidden="true"></i> Reformat page into two columns.</li>
          <li><i class="fa fa-check" aria-hidden="true"></i> Read through code for review</li>
		  <li><i class="fa fa-check" aria-hidden="true"></i> Add POST function to form</li>
          <li>Implement note saving</li>
        </ol>

      </div>

    </div>

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/js/bootstrap.min.js"></script>
    <script src="https://npmcdn.com/react@15.3.0/dist/react.js"></script>
    <script src="https://npmcdn.com/react-dom@15.3.0/dist/react-dom.js"></script>
    <script src="https://npmcdn.com/babel-core@5.8.38/browser.min.js"></script>
    <script type="text/babel">
      var NotesBox = React.createClass({
        getInitialState: function(){
          return { notes: []}
        },

        componentDidMount: function(){
          $.ajax({
            url: this.props.notesUrl,
            dataType: 'json',
            success: (data) => {
              this.setState({notes: data});
            },
            failure: (data) => {
              console.error('USER (MCALE) CREATED ERROR: ' +  data);
            }
          });
        },

		handleNoteSubmit: function(note){
			$.ajax({
				url: this.props.notesUrl,
				method: 'POST',
				data: note
			})
		},

        render: function(){
          return (
            <div className="NotesBox">
              <NotesData notes={this.state.notes} />
              <NotesForm onNoteSubmit={this.handleNoteSubmit} />
            </div>
          )
        }
      });

      var NotesForm =  React.createClass({

        getInitialState: function() {
          return {note: ''}
        },

        handleNoteChange: function(event){
          event.preventDefault();
          this.setState({
            note: event.target.value
          })
        },

		handleSubmit: function(event){
		  event.preventDefault();
		  var note = this.state.note.trim();

		  if (!note) {
		  	return;
		  }

		  this.props.onNoteSubmit({note: note})

		  this.setState({
			note: ''
		  })
		},

        render: function() {
          return (
            <form action="Post" onSubmit={this.handleSubmit}>
              <h1>
                <input
                  type="textarea"
                  value={this.state.note}
                  onChange={this.handleNoteChange}
                  placeholder="Put your note here..." />
              </h1>
              <button className="btn btn-primary">
                Save Note
              </button>
            </form>
          )
        }
      });

      var NotesData =  React.createClass({
        render: function() {
          // Learn about map()
          var noteNodes =  this.props.notes.map((note) => {
            return (
              <Note name={note.name} text={note.text} key={note.id}/>
            )
          });
          return (
            <div>{noteNodes}</div>
          )
        }
      });

      var Note =  React.createClass({
        render: function(){
          return (
            <div className='note'>
             <h3>
              {this.props.name}
             </h3>
             <p>{this.props.text}</p>
            </div>
          )
        }
      });


      setInterval(function() {
        ReactDOM.render(<NotesBox notesUrl='/api/notes' />, document.getElementById('example'))
      }, 100);

    </script>
  </body>
</html>
